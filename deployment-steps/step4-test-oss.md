# 第四步：测试OSS集成

## 测试前准备

### 1. 确认已完成
- ✅ OSS Bucket创建
- ✅ CORS配置
- ✅ RAM用户和密钥
- ✅ 密钥已配置到 `.env.local`
- ✅ ali-oss依赖已安装

### 2. 创建测试页面

我已经为你准备了一个OSS测试页面，可以验证配置是否正确。

## 运行测试

### 步骤1：启动开发服务器
```bash
npm run dev
```

### 步骤2：访问测试页面
打开浏览器访问：http://localhost:5173/test-oss

### 步骤3：测试功能
1. **连接测试**：点击"测试OSS连接"
2. **上传测试**：选择一个小文件上传
3. **查看结果**：检查是否成功

## 测试项目

### ✅ 成功标志
- 连接测试显示"连接成功"
- 文件上传有进度条
- 上传完成后显示文件URL
- 可以通过URL访问文件

### ❌ 常见问题

#### 1. "AccessKeyId is empty"
**原因**：密钥未配置
**解决**：检查 `.env.local` 文件是否正确填写

#### 2. "InvalidAccessKeyId"
**原因**：密钥错误
**解决**：确认AccessKey ID和Secret正确

#### 3. "AccessDenied"
**原因**：权限不足
**解决**：检查RAM用户是否有OSS权限

#### 4. CORS错误
**原因**：跨域未配置
**解决**：检查Bucket的CORS设置

## 切换到OSS存储

测试成功后，修改 `.env.local`：
```env
# 启用OSS
VITE_USE_OSS=true
```

然后重启开发服务器：
```bash
# Ctrl+C 停止
npm run dev
```

## 集成到知识库

OSS配置成功后，知识库的文件上传会自动使用OSS：
1. 访问知识库页面
2. 上传文档测试
3. 确认文件保存到OSS

## 下一步

完成测试后，我们将：
1. 部署到Vercel
2. 配置生产环境
3. 上线测试

---

**现在请先配置好密钥，然后告诉我"密钥已配置"，我会创建测试页面帮你验证！**